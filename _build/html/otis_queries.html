

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>OTIS-related queries &mdash; ILAO 2.17.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Legal Information" href="legal_information.html" />
    <link rel="prev" title="E-transfers with LegalServer" href="otis_integration_legal_server_integration.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ILAO
          

          
          </a>

          
            
            
              <div class="version">
                2.17.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="get_legal_help.html">Get Legal Help</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="referrals.html">Referrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="legal_self_help_centers.html">Legal Self-Help Center Directory</a></li>
<li class="toctree-l2"><a class="reference internal" href="otis_integration.html">Online Triage and Intake System (OTIS)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">OTIS-related queries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#legal-issues-with-any-triage-rules">Legal issues with any triage rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#legal-issues-with-published-triage-rules">Legal issues with published triage rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#legal-issues-with-no-triage-rules-regardless-of-level">Legal issues with no triage rules, regardless of level</a></li>
<li class="toctree-l3"><a class="reference internal" href="#legal-issues-with-no-triage-rules-lowest-level-terms-only">Legal issues with no triage rules, lowest level terms only</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="legal_information.html">Legal Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="for_legal_professionals.html">For Legal Professionals</a></li>
<li class="toctree-l1"><a class="reference internal" href="site_search.html">Site Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="site_faqs.html">Site FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="about_us.html">ILAO Organization Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="ilao_blog.html">ILAO Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="comments_ratings.html">Comments &amp; Ratings System</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_engagement.html">Share Bar &amp; Favorites</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact_us.html">Contacting ILAO</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing_content.html">Content Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing_people.html">User Accounts &amp; Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing_organizations.html">Managing Organizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="tech_mailchimp.html">Mailchimp Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="tech_google_groups.html">Discussion Boards &amp; Google Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="technical_information.html">Other Site Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="seo.html">SEO Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="translation_management.html">Translation Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_integrations.html">Data Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="tech_styles.html">Website Styles</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ILAO</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="get_legal_help.html">Get Legal Help</a> &raquo;</li>
        
      <li>OTIS-related queries</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/otis_queries.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="otis-related-queries">
<h1>OTIS-related queries<a class="headerlink" href="#otis-related-queries" title="Permalink to this headline">¶</a></h1>
<div class="section" id="legal-issues-with-any-triage-rules">
<h2>Legal issues with any triage rules<a class="headerlink" href="#legal-issues-with-any-triage-rules" title="Permalink to this headline">¶</a></h2>
<p>Returns all triage rules with their associated taxonomy terms.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">Select</span> <span class="k">distinct</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">entity_id</span><span class="p">,</span>
<span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">tid</span><span class="p">,</span>
<span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
<span class="n">field_data_title_field</span><span class="p">.</span><span class="n">title_field_value</span>
<span class="k">from</span> <span class="n">taxonomy_entity_index</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span>
<span class="k">on</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">tid</span> <span class="o">=</span> <span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">tid</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">node</span> <span class="k">on</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">entity_id</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">field_data_title_field</span> <span class="k">on</span> <span class="n">field_data_title_field</span><span class="p">.</span><span class="n">entity_id</span> <span class="o">=</span> <span class="n">nid</span>
<span class="k">where</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;triage_rules&#39;</span>
<span class="k">and</span> <span class="n">field_name</span> <span class="o">=</span> <span class="s1">&#39;field_legal_issues&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="legal-issues-with-published-triage-rules">
<h2>Legal issues with published triage rules<a class="headerlink" href="#legal-issues-with-published-triage-rules" title="Permalink to this headline">¶</a></h2>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">entity_id</span><span class="p">,</span>
<span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">tid</span><span class="p">,</span>
<span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">name</span><span class="p">,</span>
<span class="n">field_data_title_field</span><span class="p">.</span><span class="n">title_field_value</span>
<span class="k">from</span> <span class="n">taxonomy_entity_index</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span>
<span class="k">on</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">tid</span> <span class="o">=</span> <span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">tid</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">node</span> <span class="k">on</span> <span class="n">nid</span> <span class="o">=</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">entity_id</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">field_data_title_field</span>
<span class="k">on</span> <span class="n">field_data_title_field</span><span class="p">.</span><span class="n">entity_id</span> <span class="o">=</span> <span class="n">nid</span>
<span class="k">where</span> <span class="n">taxonomy_entity_index</span><span class="p">.</span><span class="n">bundle</span> <span class="o">=</span> <span class="s1">&#39;triage_rules&#39;</span>
<span class="k">AND</span> <span class="n">field_name</span> <span class="o">=</span> <span class="s1">&#39;field_legal_issues&#39;</span>
<span class="k">AND</span> <span class="n">node</span><span class="p">.</span><span class="n">status</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="legal-issues-with-no-triage-rules-regardless-of-level">
<h2>Legal issues with no triage rules, regardless of level<a class="headerlink" href="#legal-issues-with-no-triage-rules-regardless-of-level" title="Permalink to this headline">¶</a></h2>
<p>The tid not in clause excludes terms under About Lawyers, Courts &amp; Hearings, and Practice Resources.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT tid, name from taxonomy_term_data where tid not in
(SELECT taxonomy_entity_index.tid from taxonomy_entity_index
inner join taxonomy_term_data
on taxonomy_entity_index.tid = taxonomy_term_data.tid
inner join node on nid = taxonomy_entity_index.entity_id
inner join field_data_title_field on field_data_title_field.entity_id = nid
WHERE taxonomy_entity_index.bundle = &#39;triage_rules&#39;
AND field_name = &#39;field_legal_issues&#39; and node.status = 1)
AND vid = 61 and tid not in
(517836, 517841, 517846, 524176, 524156, 524161, 524221,
524171, 524211, 524181, 524236, 524306, 517851, 517856,
517866, 517896, 517906, 517901, 522986, 517911, 517861,
517921, 517936, 517926, 517916, 517931, 517941, 517946,
522646, 517951, 517956, 517966, 517976, 517961, 517971,
 517871, 517876, 517886, 517891, 517881)
</pre></div>
</div>
</div>
<div class="section" id="legal-issues-with-no-triage-rules-lowest-level-terms-only">
<h2>Legal issues with no triage rules, lowest level terms only<a class="headerlink" href="#legal-issues-with-no-triage-rules-lowest-level-terms-only" title="Permalink to this headline">¶</a></h2>
<p>The tid not in clause excludes terms under About Lawyers, Courts &amp; Hearings, and Practice Resources. Only taxonomy terms that are not parent terms are included.  This means only those terms that are the lowest level terms are returned.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT tid, name from taxonomy_term_data where tid not in
(SELECT taxonomy_entity_index.tid from taxonomy_entity_index
inner join taxonomy_term_data
on taxonomy_entity_index.tid = taxonomy_term_data.tid
inner join node on nid = taxonomy_entity_index.entity_id
inner join field_data_title_field on field_data_title_field.entity_id = nid
WHERE taxonomy_entity_index.bundle = &#39;triage_rules&#39;
AND field_name = &#39;field_legal_issues&#39; and node.status = 1)
AND vid = 61 and tid not in
(517836, 517841, 517846, 524176, 524156, 524161, 524221,
524171, 524211, 524181, 524236, 524306, 517851, 517856,
517866, 517896, 517906, 517901, 522986, 517911, 517861,
517921, 517936, 517926, 517916, 517931, 517941, 517946,
522646, 517951, 517956, 517966, 517976, 517961, 517971,
517871, 517876, 517886, 517891, 517881)
and tid not in (SELECT parent from taxonomy_term_hierarchy)
</pre></div>
</div>
<p>Gets all intake settings by zip code when coded by city</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">tid</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">field_data_field_cities</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span>
<span class="k">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span> <span class="k">and</span> <span class="n">tid</span> <span class="k">in</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span>
 <span class="k">where</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">field_data_field_cities</span><span class="p">.</span><span class="n">field_cities_target_id</span><span class="p">)</span>
</pre></div>
</div>
<p>Gets all intake settings by zip code when coded to counties</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT tid, name, entity_id
FROM field_data_field_counties
INNER JOIN  taxonomy_term_data
WHERE  entity_type = &#39;oas_intake_settings&#39; AND  tid in
(SELECT tid from taxonomy_term_hierarchy where parent in
(Select tid from taxonomy_term_hierarchy where parent in
(Select tid from taxonomy_term_data
 where tid = field_data_field_counties.field_counties_target_id)))
</pre></div>
</div>
<p>All IL zip codes</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">Select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span>
<span class="k">inner</span> <span class="k">join</span> <span class="n">taxonomy_term_data</span>
<span class="k">on</span> <span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">tid</span> <span class="o">=</span> <span class="n">taxonomy_term_hierarchy</span><span class="p">.</span><span class="n">tid</span>
<span class="k">WHERE</span> <span class="n">parent</span> <span class="k">in</span>
<span class="p">(</span><span class="k">select</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span>
   <span class="k">where</span> <span class="n">parent</span> <span class="k">in</span>
   <span class="p">(</span><span class="k">select</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_hierarchy</span> <span class="k">where</span> <span class="n">parent</span> <span class="o">=</span>
   <span class="p">(</span><span class="k">Select</span> <span class="n">tid</span> <span class="k">from</span> <span class="n">taxonomy_term_data</span> <span class="k">where</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Illinois&#39;</span><span class="p">)))</span>
<span class="k">and</span> <span class="n">taxonomy_term_data</span><span class="p">.</span><span class="n">vid</span> <span class="o">=</span> <span class="mi">76</span>
</pre></div>
</div>
<p>Intake settings by location setting</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span> <span class="k">SELECT</span> <span class="n">intake_settings_id</span><span class="p">,</span>
 <span class="k">CASE</span>
  <span class="k">WHEN</span> <span class="n">intake_settings_id</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">field_data_field_statewide</span> <span class="k">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span> <span class="k">and</span> <span class="n">field_data_field_statewide</span><span class="p">.</span><span class="n">field_statewide_value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span> <span class="s1">&#39;statewide&#39;</span>
  <span class="k">WHEN</span> <span class="n">intake_settings_id</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">field_data_field_cities</span> <span class="k">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span><span class="p">)</span> <span class="k">THEN</span> <span class="s1">&#39;city-limited&#39;</span>
  <span class="k">WHEN</span> <span class="n">intake_settings_id</span> <span class="k">in</span> <span class="p">(</span><span class="k">Select</span> <span class="n">entity_id</span> <span class="k">from</span> <span class="n">field_data_field_counties</span> <span class="k">where</span> <span class="n">entity_type</span> <span class="o">=</span> <span class="s1">&#39;oas_intake_settings&#39;</span><span class="p">)</span> <span class="k">THEN</span> <span class="s1">&#39;county-limited&#39;</span>
 <span class="k">ELSE</span> <span class="s1">&#39;localized&#39;</span>
<span class="k">END</span>
<span class="k">from</span> <span class="n">oas_intake_settings</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="legal_information.html" class="btn btn-neutral float-right" title="Legal Information" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="otis_integration_legal_server_integration.html" class="btn btn-neutral" title="E-transfers with LegalServer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Illinois Legal Aid Online.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.17.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>